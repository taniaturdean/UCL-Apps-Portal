{"ast":null,"code":"import _slicedToArray from\"/Users/isobelbarkley/Documents/appeng/COMP0067_2023_Team09/ucl-apps-portal/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"../pages/HomePage.css\";import{useState,useEffect}from\"react\";import{Switch,FormControlLabel}from\"@mui/material\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";axios.defaults.withCredentials=true;var ApprovalSwitch=function ApprovalSwitch(props){var initialState;if(props.approved===1){initialState=true;}else{initialState=false;}var navigate=useNavigate();var _useState=useState(initialState),_useState2=_slicedToArray(_useState,2),approved=_useState2[0],setApproved=_useState2[1];// useEffect(() => {\n//   const listingID = props.listingID;\n//   // get initial approval state of listing from db\n//   axios\n//     .get(`http://localhost:5500/admin/listings/approval-state/${listingID}`)\n//     .then((response) => {\n//       if (response.data.auth === false) {\n//         // if jwt has expired\n//         navigate('/expired');\n//       } else {\n//         // set state to api response\n//         setApproved(response.data.approvalState[0][0]['approved']);\n//       }\n//     })\n//     .catch((error) => {\n//       console.log(error);\n//     });\n// }, [navigate]);\nvar handleToggle=function handleToggle(){var listingID=props.listingID;var approval;if(listingID){if(!approved){// If not approved send request to approve (approval = 1)\napproval=1;}else{// If approved send request to unapprove\napproval=0;}axios.patch(\"http://localhost:5500/admin/listings/change-approval/\".concat(listingID),{approval:approval}).then(function(response){console.log(response);if(response.data.auth===false){navigate(\"/unauthorised\");}else if(response.data.result===\"success\"){// change state\nsetApproved(!approved);}else{navigate(\"/error\");}}).catch(function(err){console.log(err);});}else{console.log(\"Listing ID prop not defined\");}};return/*#__PURE__*/_jsx(\"main\",{className:\"home-page\",children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:approved,onChange:handleToggle,color:\"primary\",name:\"approvalSwitch\",inputProps:{\"aria-label\":\"approve or disapprove\"}}),label:approved?\"approved\":\"unapproved\"})});};export default ApprovalSwitch;","map":{"version":3,"names":["useState","useEffect","Switch","FormControlLabel","axios","useNavigate","jsx","_jsx","defaults","withCredentials","ApprovalSwitch","props","initialState","approved","navigate","_useState","_useState2","_slicedToArray","setApproved","handleToggle","listingID","approval","patch","concat","then","response","console","log","data","auth","result","catch","err","className","children","control","checked","onChange","color","name","inputProps","label"],"sources":["/Users/isobelbarkley/Documents/appeng/COMP0067_2023_Team09/ucl-apps-portal/client/src/components/ApprovalSwitch.js"],"sourcesContent":["import \"../pages/HomePage.css\";\nimport { useState, useEffect } from \"react\";\nimport { Switch, FormControlLabel } from \"@mui/material\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\naxios.defaults.withCredentials = true;\n\nconst ApprovalSwitch = (props) => {\n\n  var initialState;\n\n  if (props.approved === 1) {\n    initialState = true\n  } else {\n    initialState = false\n  }\n  \n  const navigate = useNavigate();\n  const [approved, setApproved] = useState(initialState);\n\n  // useEffect(() => {\n  //   const listingID = props.listingID;\n  //   // get initial approval state of listing from db\n  //   axios\n  //     .get(`http://localhost:5500/admin/listings/approval-state/${listingID}`)\n  //     .then((response) => {\n  //       if (response.data.auth === false) {\n  //         // if jwt has expired\n  //         navigate('/expired');\n  //       } else {\n  //         // set state to api response\n  //         setApproved(response.data.approvalState[0][0]['approved']);\n  //       }\n  //     })\n  //     .catch((error) => {\n  //       console.log(error);\n  //     });\n  // }, [navigate]);\n\n  const handleToggle = () => {\n    const listingID = props.listingID;\n    var approval;\n\n    if (listingID) {\n      if (!approved) {\n        // If not approved send request to approve (approval = 1)\n        approval = 1;\n      } else {\n        // If approved send request to unapprove\n        approval = 0;\n      }\n      axios\n        .patch(`http://localhost:5500/admin/listings/change-approval/${listingID}`, {\n          approval: approval,\n        })\n        .then((response) => {\n          console.log(response);\n          if (response.data.auth === false) {\n            navigate(\"/unauthorised\");\n          } else if (response.data.result === \"success\") {\n            // change state\n            setApproved(!approved);\n          } else {\n            navigate(\"/error\");\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    } else {\n      console.log(\"Listing ID prop not defined\");\n    }\n  };\n\n  return (\n    <main className=\"home-page\">\n      <FormControlLabel\n        control={\n          <Switch\n            checked={approved}\n            onChange={handleToggle}\n            color=\"primary\"\n            name=\"approvalSwitch\"\n            inputProps={{ \"aria-label\": \"approve or disapprove\" }}\n          />\n        }\n        label={approved ? \"approved\" : \"unapproved\"}\n      />\n    </main>\n  );\n};\n\nexport default ApprovalSwitch;\n"],"mappings":"uKAAA,MAAO,uBAAuB,CAC9B,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,MAAM,CAAEC,gBAAgB,KAAQ,eAAe,CACxD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE/CH,KAAK,CAACI,QAAQ,CAACC,eAAe,CAAG,IAAI,CAErC,GAAM,CAAAC,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAAIC,KAAK,CAAK,CAEhC,GAAI,CAAAC,YAAY,CAEhB,GAAID,KAAK,CAACE,QAAQ,GAAK,CAAC,CAAE,CACxBD,YAAY,CAAG,IAAI,CACrB,CAAC,IAAM,CACLA,YAAY,CAAG,KAAK,CACtB,CAEA,GAAM,CAAAE,QAAQ,CAAGT,WAAW,EAAE,CAC9B,IAAAU,SAAA,CAAgCf,QAAQ,CAACY,YAAY,CAAC,CAAAI,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA/CF,QAAQ,CAAAG,UAAA,IAAEE,WAAW,CAAAF,UAAA,IAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAM,CAAAG,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,CAAS,CACzB,GAAM,CAAAC,SAAS,CAAGT,KAAK,CAACS,SAAS,CACjC,GAAI,CAAAC,QAAQ,CAEZ,GAAID,SAAS,CAAE,CACb,GAAI,CAACP,QAAQ,CAAE,CACb;AACAQ,QAAQ,CAAG,CAAC,CACd,CAAC,IAAM,CACL;AACAA,QAAQ,CAAG,CAAC,CACd,CACAjB,KAAK,CACFkB,KAAK,yDAAAC,MAAA,CAAyDH,SAAS,EAAI,CAC1EC,QAAQ,CAAEA,QACZ,CAAC,CAAC,CACDG,IAAI,CAAC,SAACC,QAAQ,CAAK,CAClBC,OAAO,CAACC,GAAG,CAACF,QAAQ,CAAC,CACrB,GAAIA,QAAQ,CAACG,IAAI,CAACC,IAAI,GAAK,KAAK,CAAE,CAChCf,QAAQ,CAAC,eAAe,CAAC,CAC3B,CAAC,IAAM,IAAIW,QAAQ,CAACG,IAAI,CAACE,MAAM,GAAK,SAAS,CAAE,CAC7C;AACAZ,WAAW,CAAC,CAACL,QAAQ,CAAC,CACxB,CAAC,IAAM,CACLC,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAC,CAAC,CACDiB,KAAK,CAAC,SAACC,GAAG,CAAK,CACdN,OAAO,CAACC,GAAG,CAACK,GAAG,CAAC,CAClB,CAAC,CAAC,CACN,CAAC,IAAM,CACLN,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC,CAC5C,CACF,CAAC,CAED,mBACEpB,IAAA,SAAM0B,SAAS,CAAC,WAAW,CAAAC,QAAA,cACzB3B,IAAA,CAACJ,gBAAgB,EACfgC,OAAO,cACL5B,IAAA,CAACL,MAAM,EACLkC,OAAO,CAAEvB,QAAS,CAClBwB,QAAQ,CAAElB,YAAa,CACvBmB,KAAK,CAAC,SAAS,CACfC,IAAI,CAAC,gBAAgB,CACrBC,UAAU,CAAE,CAAE,YAAY,CAAE,uBAAwB,CAAE,EAEzD,CACDC,KAAK,CAAE5B,QAAQ,CAAG,UAAU,CAAG,YAAa,EAC5C,EACG,CAEX,CAAC,CAED,cAAe,CAAAH,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}